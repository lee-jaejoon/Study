# 8. Contraction Rates: General Theory
## 8.1 Introduction

### Definition 8.1 (Contraction rate)

*A sequence $\epsilon_n$ is a **posterior contraction rate** at the parameter $\theta_0$ with respect to the semimetric $d$ if $\Pi_n( \theta : d(\theta, \theta_0) \ge M_n \epsilon_n \vert X^{(n)} ) \to 0$ in $P_{\theta_0}^{(n)}$-probability, for every $M_n \to \infty$. If all experiments share the same probability space and the convergence to zero takes place almost surely $[P_{\theta_0}^{(\infty)}]$, then $\epsilon_n$ is said to be a **posterior contraction rate in the strong sense**.*

* 위 정의의 statement 중, "the" contraction rate가 아니라 "a" contraction rate임에 주목.

  * $\epsilon_n$이 contraction rate이라면, 그보다 느리게 0으로 가는 $\epsilon^\prime_n$은 역시 contraction rate이 된다.
    $$
    0 \le \Pi_n( \theta : d(\theta, \theta_0) \ge M_n \epsilon_n^\prime \vert X^{(n)}) \le \Pi_n( \theta : d(\theta, \theta_0) \ge M_n \epsilon_n \vert X^{(n)}) \to 0
    $$

  * 우리는 이 rate 중 가장 빠르게 0으로 감소하는 $\epsilon_n$에 관심이 있다.

    * 그러나 이는 존재하지 않을 수 있고 관련된 성질을 정립하기도 어려움.
    * 따라서 이 감소하는 rate의 upper bound를 구하고 이것이 "optimal" rate와 같거나 혹은 가까우면 만족함.

### Lemma 8.2

*If $\Theta \subset \mathbb R$ and $E(\theta \vert X^{(n)}) = \theta_0 + O_p(\epsilon_n) $ and $V(\theta \vert X^{(n)}) = O_p(\epsilon_n^2) $, with respect to the distribution generated by the true parameter $\theta_0$, then $\epsilon_n$ is a rate of contraction at $\theta_0$ with respect to the Euclidean measure.*

* 이는 Posterior mean, variance가 explicit expression으로 표현되는 경우 적용할 수 있는 정리이다.

  * Example 8.3, 8.4 참고.

* Chebyshev's inequality에 의해, for any $M_n \to \infty$,
  $$
  \Pi_n\left( \theta : \vert\theta - E(\theta \vert X^{(n)})\vert \ge M_n \epsilon_n \Big\vert X^{(n)}\right) \le \frac{V(\theta \vert X^{(n)}) }{(M_n \epsilon_n)^2} \stackrel{P}{\to} 0
  $$

* $\vert E(\theta \vert X^{(n)}) - \theta_0 \vert = O_p(\epsilon_n) $이므로,
  $$
  \Pi_n\left( \theta : \left\vert E(\theta \vert X^{(n)}) - \theta_0 \right\vert \ge M_n \epsilon_n \Big\vert X^{(n)}\right)  \stackrel{P}{\to} 0
  $$

* 따라서
  $$
  \begin{align*}
  &\Pi_n\left( \theta : \left\vert \theta - \theta_0 \right\vert \ge M_n \epsilon_n \Big\vert X^{(n)}\right) \\
  &\le \Pi_n\left( \theta : \left\vert \theta - E(\theta \vert X^{(n)}) \right\vert \ge M_n \epsilon_n \Big\vert X^{(n)}\right)+\Pi_n\left( \theta : \left\vert E(\theta \vert X^{(n)}) - \theta_0 \right\vert \ge M_n \epsilon_n \Big\vert X^{(n)}\right) \stackrel{P}{\to} 0 
  
  \end{align*}
  $$

### Example 8.3 (Bernoulli)

$$
\begin{align*}
\theta &\sim \text{Be}(a, b) \\
X_1, \cdots, X_n \vert \theta &\stackrel{\text{iid}}{\sim} \text{Bin}(1, \theta) \\
\implies \quad \theta \vert X_1, \cdots, X_n  &\stackrel{\text{iid}}{\sim} \text{Be}\left(a + n\bar{X}_n, b + n - n \bar{X}_n \right) \\
\end{align*}
$$

### Example 8.4 (Uniform)

### Example 8.5 (Dirichlet process)

### Example 8.6 (White noise model)

### 

### Theorem 8.7

If the posterior contraction rate at $\theta_0$ is $\epsilon_n$, then the center $\hat{\theta}_n$ of the smallest ball that contains posterior mass at least $1/2$ satisfies $d(\hat{\theta}_n, \theta_0 ) = O_p(\epsilon_n)$ in $P^{(n)}_{\theta_0}$-probability (or almost surely if the posterior contraction rate is in the strong sense).

* Contraction of the posterior distribution at a rate implies the existence of point estimators that converge at the same rate.

### Theorem 8.8





## 8.2 Independent Identically Distributed Observations

### Settings

* 이 section에서는 probability density $p$를 parameter로 둔다.

  * $\mathcal P$ : a class of probability densities relative to a given dominating measure $\nu$ on a sample space $(\mathfrak X,\mathscr X)$.
  * $p_0$ : true density.

* Test function $\phi_n$ : measurable mapping $\phi_n : \mathfrak X^n \to [0,1]$.

  * Null hypothesis를 기각할 확률로 이해하면 된다.
  * 이 test function에 대한 적분을 아래와 같이 나타낸다.

  $$
  P^n \phi_n = E_p \phi_n(X_1, \cdots, X_n)= \int \phi_n dP^n \\
  P^n_0 \phi_n = E_{p_0} \phi_n(X_1, \cdots, X_n)= \int \phi_n dP_0^n \\
  $$

* 아래 조건이 만족하는 metric $d$ on parameter space $\mathcal P$에 대하여 posterior contraction rate을 도출하고자 한다.

  * For every $n \in \mathbb N$ and $\epsilon > 0$ and $p_1$ with $d(p_1, p_0) > \epsilon$, there exists a **test** $\phi_n$ with, for some universal constants $\xi, K > 0$, 
    $$
    P_0^n \phi_n \le e^{-K n \epsilon^2}, \quad \sup_{d(p,p_1) < \xi \epsilon} P^n(1-\phi_n) \le e^{-K n \epsilon^2}.
    $$

  * Null hypothesis $P_0$는



























